window.cdMenu=function(e){function t(e,t,n,r){var c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===this.readyState&&200===this.status)try{var e=JSON.parse(this.responseText);n(e)}catch(e){r(e)}else 4===this.readyState&&r(this)},c.open(t?"POST":"GET",e,!0),c.withCredentials=!0,t&&c.setRequestHeader("Content-type","application/json"),c.send(t)}function n(e,t){return Array.prototype.forEach.call(e,t)}function r(e){e.style.display=this.display||"block",e.setAttribute("style","display: "+e.style.display+" !important;")}function c(e){e.setAttribute("style","display: none !important;")}function o(){n(L,r.bind({display:"flex"}))}function i(){n(L,c)}function u(){h.setAttribute("data-toggle","closed"),b.className="cd-menu__scrim",n(v,function(e){e.setAttribute("data-toggle","closed")})}function d(){h.setAttribute("data-toggle","open"),b.className="cd-menu__scrim cd-menu__scrim--visible"}function l(e){e.target!==E&&e.target.parentElement!==E&&E.setAttribute("data-toggle","closed"),n(k,function(t){e.target!==t&&e.target.parentElement!==t&&e.target.parentElement.parentElement!==t&&t.setAttribute("data-toggle","closed")})}function a(){"open"===this.getAttribute("data-toggle")?this.setAttribute("data-toggle","closed"):this.setAttribute("data-toggle","open")}function s(e){for(var t=0,n=0,r=!1,c=["mentor","champion","parent-guardian"];!r&&n<e.length;){for(var o=e[n];!r&&t<o.userTypes.length;){var i=o.userTypes[t];c.indexOf(i)>-1&&(r=!0),t+=1}n+=1}return r}function m(){A.addEventListener("click",function(){"open"===h.getAttribute("data-toggle")?u():d()}),b.addEventListener("click",u),n(S,function(e){e.addEventListener("click",u)}),n(q,function(e){var t=e.parentElement.querySelector(".cd-menu__sliding-menu-secondary"),n=t.querySelector(".cd-menu__back-button");n&&n.addEventListener("click",function(){t.setAttribute("data-toggle","closed")}),e&&e.addEventListener("click",function(){t.setAttribute("data-toggle","open")})})}function f(){n(k,function(e){e.addEventListener("click",a)}),E&&E.addEventListener("click",a),document.getElementsByTagName("body")[0].addEventListener("click",l),document.getElementsByTagName("body")[0].addEventListener("touchstart",l)}function p(){E&&E.addEventListener("click",a),n(I,function(e){e.addEventListener("click",function(e){e.preventDefault(),window.location.href=this.href+"?referer="+encodeURIComponent(window.location)})})}function y(){t(g+"/api/2.0/users/instance",null,function(e){e&&e.user?(n(_,function(e){e.setAttribute("data-loggedin",!0)}),n(x,function(t){t.innerText=e.user.name}),n(N,function(t){t.href=g+"/dashboard/profile/"+e.user.id+"/edit"}),n(O,function(t){t.style.backgroundImage="url("+g+"/api/2.0/profiles/"+e.user.profileId+"/avatar_img)"}),-1===e.user.initUserType.indexOf("attendee")&&n(j,r),-1!==e.user.roles.indexOf("cdf-admin")&&n(w,r),n(T,function(e){e.style.display="flex"}),i(),t(g+"/api/2.0/dojos/users",'{"query": {"userId":"'+e.user.id+'"}}',function(t){var c=JSON.parse(e.user.initUserType);if(t.push({userTypes:[c.name]}),t&&t.length>0){s(t)&&n(M,r)}})):o()},o)}e||(e={});var g=e.zenBase||"https://zen.coderdojo.com";g=g.replace(/\/$/,"");var _=document.querySelectorAll(".cd-menu"),A=document.querySelector(".cd-menu__hamburger"),h=document.querySelector("#cd-menu__sliding-menu-primary"),b=document.querySelector(".cd-menu__scrim"),v=document.querySelectorAll(".cd-menu__sliding-menu-secondary"),S=document.querySelectorAll(".cd-menu__close-button"),q=document.querySelectorAll(".cd-menu__sliding-menu .cd-menu__content ul > li > span"),E=document.querySelector(".cd-menu__desktop-nav .cd-menu__profile"),k=document.querySelectorAll(".cd-menu__dropdown"),w=document.querySelectorAll(".cd-menu__cdf-admin-link"),L=document.querySelectorAll(".cd-menu__account"),T=document.querySelectorAll(".cd-menu__profile"),x=document.querySelectorAll(".cd-menu__profile-name"),N=document.querySelectorAll(".cd-menu__profile-link"),O=document.querySelectorAll(".cd-menu__profile-pic"),I=document.querySelectorAll(".cd-menu__referer-link"),M=document.querySelectorAll(".cd-menu__e-learning-link"),j=document.querySelectorAll(".cd-menu__parent-link");window.cdMenu.fns={loadProfileMenu:y},window.addEventListener("load",function(){m(),f(),p(),y()})};
