window.cdMenu=function(e){function t(e,t,n,r){var c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===this.readyState&&200===this.status)try{var e=JSON.parse(this.responseText);n(e)}catch(e){r(e)}else 4===this.readyState&&r(this)},c.open(t?"POST":"GET",e,!0),c.withCredentials=!0,t&&c.setRequestHeader("Content-type","application/json"),c.send(t)}function n(e,t){return Array.prototype.forEach.call(e,t)}function r(e){e.style.display="block",e.setAttribute("style","display: block !important;")}function c(e){e.style.display="block",e.setAttribute("style","display: none !important;")}function o(){n(w,r)}function i(){n(w,c)}function u(){A.setAttribute("data-toggle","closed"),b.className="cd-menu__scrim",n(h,function(e){e.setAttribute("data-toggle","closed")})}function l(){A.setAttribute("data-toggle","open"),b.className="cd-menu__scrim cd-menu__scrim--visible"}function d(e){e.target!==q&&e.target.parentElement!==q&&q.setAttribute("data-toggle","closed"),n(k,function(t){e.target!==t&&e.target.parentElement!==t&&e.target.parentElement.parentElement!==t&&t.setAttribute("data-toggle","closed")})}function a(){"open"===this.getAttribute("data-toggle")?this.setAttribute("data-toggle","closed"):this.setAttribute("data-toggle","open")}function s(e){for(var t=0,n=0,r=!1,c=["mentor","champion","parent-guardian"];!r&&n<e.length;){for(var o=e[n];!r&&t<o.userTypes.length;){var i=o.userTypes[t];c.indexOf(i)>-1&&(r=!0),t+=1}n+=1}return r}function m(){g.addEventListener("click",function(){"open"===A.getAttribute("data-toggle")?u():l()}),b.addEventListener("click",u),n(v,function(e){e.addEventListener("click",u)}),n(S,function(e){var t=e.parentElement.querySelector(".cd-menu__sliding-menu-secondary"),n=t.querySelector(".cd-menu__back-button");n&&n.addEventListener("click",function(){t.setAttribute("data-toggle","closed")}),e&&e.addEventListener("click",function(){t.setAttribute("data-toggle","open")})})}function f(){n(k,function(e){e.addEventListener("click",a)}),q.addEventListener("click",a),document.getElementsByTagName("body")[0].addEventListener("click",d),document.getElementsByTagName("body")[0].addEventListener("touchstart",d)}function p(){q.addEventListener("click",a),n(O,function(e){e.addEventListener("click",function(e){e.preventDefault(),window.location.href=this.href+"?referer="+encodeURIComponent(window.location)})})}function y(){t(_+"/api/2.0/users/instance",null,function(e){e&&e.user?(n(T,function(t){t.innerText=e.user.name}),n(x,function(t){t.href=_+"/dashboard/profile/"+e.user.id+"/edit"}),n(N,function(t){t.style.backgroundImage="url("+_+"/api/2.0/profiles/"+e.user.profileId+"/avatar_img)"}),-1===e.user.initUserType.indexOf("attendee")&&n(M,r),-1!==e.user.roles.indexOf("cdf-admin")&&n(E,r),n(L,function(e){e.style.display="flex"}),i(),t(_+"/api/2.0/dojos/users",'{"query": {"userId":"'+e.user.id+'"}}',function(t){var c=JSON.parse(e.user.initUserType);if(t.push({userTypes:[c.name]}),t&&t.length>0){s(t)&&n(I,r)}})):o()},o)}e||(e={});var _=e.zenBase||"https://zen.coderdojo.com";_=_.replace(/\/$/,"");var g=document.querySelector(".cd-menu__hamburger"),A=document.querySelector("#cd-menu__sliding-menu-primary"),b=document.querySelector(".cd-menu__scrim"),h=document.querySelectorAll(".cd-menu__sliding-menu-secondary"),v=document.querySelectorAll(".cd-menu__close-button"),S=document.querySelectorAll(".cd-menu__sliding-menu .cd-menu__content > ul > li > span"),q=document.querySelector(".cd-menu__desktop-nav .cd-menu__profile"),k=document.querySelectorAll(".cd-menu__dropdown"),E=document.querySelectorAll(".cd-menu__cdf-admin-link"),w=document.querySelectorAll(".cd-menu__account"),L=document.querySelectorAll(".cd-menu__profile"),T=document.querySelectorAll(".cd-menu__profile-name"),x=document.querySelectorAll(".cd-menu__profile-link"),N=document.querySelectorAll(".cd-menu__profile-pic"),O=document.querySelectorAll(".cd-menu__referer-link"),I=document.querySelectorAll(".cd-menu__e-learning-link"),M=document.querySelectorAll(".cd-menu__parent-link");window.cdMenu.fns={loadProfileMenu:y},window.addEventListener("load",function(){m(),f(),p(),y()})};
